#import "lib/gost.typ": init

#show: init

= Цель работы

Освоить методы статистической обработки результатов измерений: проверку гипотезы о нормальном распределении генеральной совокупности, вычисление несмещённых оценок параметров распределения и построение доверительных интервалов.

= Вариант задания

Вариант 4. Исходные данные (50 элементов):

#figure(
  table(
    columns: (1fr,) * 10,
    align: center,
    [6.40], [7.40], [7.08], [8.87], [8.19], [11.15], [6.68], [4.92], [7.18], [6.29],
    [10.99], [8.78], [5.68], [8.18], [8.93], [2.38], [5.62], [8.04], [11.52], [7.96],
    [6.85], [8.56], [8.15], [7.05], [7.69], [5.80], [4.47], [8.64], [7.83], [8.42],
    [8.96], [7.82], [6.64], [8.00], [5.58], [9.67], [6.03], [12.21], [7.95], [6.53],
    [6.40], [8.10], [10.95], [8.90], [4.87], [9.34], [10.00], [6.36], [9.86], [7.83],
  ),
  caption: [Исходные данные варианта 4],
)

Уровень значимости: $alpha = 0.05$, доверительная вероятность $P = 1 - alpha = 0.95$.

Выборка 1 --- все 50 элементов (для проверки гипотезы о нормальности).

Выборка 2 --- первые 20 элементов (первые две строки таблицы):
6.40; 7.40; 7.08; 8.87; 8.19; 11.15; 6.68; 4.92; 7.18; 6.29; 10.99; 8.78; 5.68; 8.18; 8.93; 2.38; 5.62; 8.04; 11.52; 7.96.

= Выполнение работы

== Задание 1. Проверка гипотезы о нормальном распределении

Выдвигается нулевая гипотеза $H_0$: генеральная совокупность имеет нормальное распределение; альтернативная гипотеза $H_1$: распределение не является нормальным. Гипотеза проверяется с помощью критерия согласия Пирсона ($chi^2$) при уровне значимости $alpha = 0.05$.

=== Построение гистограммы

Оптимальное число интервалов определяется по формуле Стёрджесса:

$ k = 1 + 3.322 dot lg n = 1 + 3.322 dot lg 50 approx 7 $

Построенная диаграмма с кривой нормального распределения представлена на рисунке @plot.

#figure(
  image("images/plot.png", width: 90%),
  caption: [Гистограмма выборки 1 с кривой нормального распределения],
) <plot>

По гистограмме выборки 1 определяются середины интервалов и число элементов в каждом интервале. Из 7 исходных интервалов крайние интервалы с малым числом наблюдений ($n_i < 5$) объединяются с соседними. 
В результате получается 4 интервала, представленные в таблице @intervals.

#figure(
  table(
    columns: (2fr, 1fr, 1fr),
    align: center,
    table.header([Интервал], [$x_i$ (середина)], [$n_i$]),
    $(-infinity;\ 6.58)$, $4.41$, $14$,
    $(6.58;\ 7.98)$,      $7.28$, $13$,
    $(7.98;\ 9.38)$,      $8.68$, $15$,
    $(9.38;\ +infinity)$, $10.69$, $8$,
  ),
  caption: [Объединённые интервалы после слияния малочисленных],
) <intervals>

Выборочное среднее и среднеквадратическое отклонение, вычисленные по середине гистограммных интервалов:

$ overline(x)_в = (sum m_i dot x_i) / n $

где $m_i$ --- число элементов в $i$-м интервале, $x_i$ --- середина интервала.

$ overline(x)_в = (1 dot 2.24 + 1 dot 3.92 + 11 dot 5.61 + 17 dot 7.30 + 13 dot 8.98 + 5 dot 10.70 + 2 dot 12.40) / 50 $

$ overline(x)_в approx 7.7402 $

Вычислим отклонения каждой середины от среднего:

$ (x_1 - overline(x)_в)^2 = (2.24 - 7.7402)^2 = (-5.5002)^2 = 30.252 $

По аналогии вычисляются остальные квадраты отклонений. Результаты сведены в таблице @std-calc.

#figure(
  table(
    columns: (1fr, 1fr, 1fr, 1fr, 1fr),
    align: center,
    table.header([$x_i$], [$m_i$], [$x_i - overline(x)_в$], [$(x_i - overline(x)_в)^2$], [$m_i (x_i - overline(x)_в)^2$]),
    [2.24],  [1],  [$-5.500$], [30.252], [30.252],
    [3.92],  [1],  [$-3.820$], [14.594], [14.594],
    [5.61],  [11], [$-2.130$], [4.538],  [49.915],
    [7.30],  [17], [$-0.440$], [0.194],  [3.294],
    [8.98],  [13], [1.240],    [1.537],  [19.982],
    [10.70], [5],  [2.960],    [8.760],  [43.802],
    [12.40], [2],  [4.660],    [21.714], [43.428],
    table.cell(colspan: 4, align: right)[Сумма:], [205.267],
  ),
  caption: [Вычисление среднеквадратического отклонения],
) <std-calc>

$ S_в = sqrt((sum m_i dot (x_i - overline(x)_в)^2) / n) = sqrt(205.267 / 50) = sqrt(4.105) approx 2.026 $

=== Вычисление теоретических частот

Для каждого объединённого интервала $(a_i; b_i)$ вероятность попадания значения при нормальном распределении вычисляется через функцию Лапласа:

$ P_i = Phi(z_(b_i)) - Phi(z_(a_i)), quad z = (x - overline(x)_в) / S_в $

$Phi$ --- функция Лапласа.

Теоретическая частота для первого интервала $(-infinity; 6.58)$:

$ z_(b_1) = (6.58 - 7.7402) / (2.0262) approx -0.573 $

$ P_1 = Phi(-0.573) - Phi(-infinity) = Phi(-0.573) + 0.5 approx 0.2835 $

$ n'_1 = n dot P_1 = 50 dot 0.2835 approx 14.17 $

По аналогии вычисляются теоретические частоты для остальных интервалов. Компонента критерия Пирсона для каждого интервала:

$ (n_i - n'_i)^2 / n'_i $

Для первого интервала:

$ (n_1 - n'_1)^2 / n'_1 = (14 - 14.17)^2 / 14.17 = 0.029 / 14.17 approx 0.002 $

Для второго интервала $(6.58;\ 7.98)$: $z_(a_2) = -0.573$, $z_(b_2) = (7.98 - 7.7402) / 2.026 approx 0.118$,

$ P_2 = Phi(0.118) - Phi(-0.573) approx 0.2637, quad n'_2 = 50 dot 0.2637 approx 13.18 $

$ (n_2 - n'_2)^2 / n'_2 = (13 - 13.18)^2 / 13.18 = 0.032 / 13.18 approx 0.002 $

Для третьего интервала $(7.98;\ 9.38)$: $z_(b_3) = (9.38 - 7.7402) / 2.026 approx 0.809$,

$ P_3 = Phi(0.809) - Phi(0.118) approx 0.2437, quad n'_3 = 50 dot 0.2437 approx 12.19 $

$ (n_3 - n'_3)^2 / n'_3 = (15 - 12.19)^2 / 12.19 = 7.896 / 12.19 approx 0.648 $

Для четвёртого интервала $(9.38;\ +infinity)$:

$ P_4 = 0.5 - Phi(0.809) approx 0.2092, quad n'_4 = 50 dot 0.2092 approx 10.46 $

$ (n_4 - n'_4)^2 / n'_4 = (8 - 10.46)^2 / 10.46 = 6.052 / 10.46 approx 0.579 $

Результаты сведены в таблице @pearson.

#figure(
  table(
    columns: (2fr, 1fr, 1fr, 1fr, 1fr, 1fr, 1.5fr),
    align: center,
    table.header(
      [Интервал], [$z_a$], [$z_b$], [$P_i$], [$n_i$], [$n'_i$], [$(n_i - n'_i)^2 / n'_i$],
    ),
    $(-infinity;\ 6.58)$, $-infinity$, $-0.573$, $0.2835$, $14$, $14.17$, $0.0021$,
    $(6.58;\ 7.98)$,   $-0.573$, $0.118$,  $0.2637$, $13$, $13.18$, $0.0025$,
    $(7.98;\ 9.38)$,   $0.118$,  $0.809$,  $0.2437$, $15$, $12.19$, $0.6496$,
    $(9.38;\ +infinity)$, $0.809$, $+infinity$, $0.2092$, $8$,  $10.46$, $0.5779$,
  ),
  caption: [Расчёт критерия Пирсона],
) <pearson>

Наблюдаемое значение статистики:

$ chi^2_"набл" = sum_(i=1)^s (n_i - n'_i)^2 / n'_i = 0.0021 + 0.0025 + 0.6496 + 0.5779 approx 1.23 $

Число степеней свободы:

$ k = s - 1 - r = 4 - 1 - 2 = 1 $

где $s = 4$ --- число интервалов, $r = 2$ --- число оцениваемых параметров (среднее и среднеквадратическое отклонение).

Критическое значение $chi^2_"крит"$ при $alpha = 0.05$ и $k = 1$ по таблице: $chi^2_"крит" = 3.84$.

Так как $chi^2_"набл" = 1.23 < 3.84 = chi^2_"крит"$, нулевая гипотеза $H_0$ принимается. Данные распределены нормально.

== Задание 2. Несмещённые оценки параметров распределения

Выборка 2 содержит $n = 20$ элементов. Несмещённая оценка среднего арифметического:

$ overline(x) = 1/n sum_(i=1)^n x_i $

$ sum_(i=1)^n x_i = 6.40 + 7.40 + 7.08 + 8.87 + 8.19 + 11.15 + 6.68 + 4.92 + 7.18 + 6.29 $
$ + 10.99 + 8.78 + 5.68 + 8.18 + 8.93 + 2.38 + 5.62 + 8.04 + 11.52 + 7.96 = 152.24 $

$ overline(x) = 152.24 / 20 = 7.612 $

Несмещённая оценка дисперсии (исправленная выборочная дисперсия):

$ S^2 = 1/(n-1) sum_(i=1)^n (x_i - overline(x))^2 $

Для первого элемента слагаемое в числителе:

$ (x_1 - overline(x))^2 = (6.40 - 7.612)^2 = (-1.212)^2 = 1.469 $

По аналогии вычисляются все остальные слагаемые. Результаты сведены в таблице @variance-calc.

#figure(
  table(
    columns: (1fr, 1fr, 1fr) * 2,
    align: center,
    table.header([$x_i$], [$x_i - overline(x)$], [$(x_i - overline(x))^2$],
                 [$x_i$], [$x_i - overline(x)$], [$(x_i - overline(x))^2$]),
    [6.40],  [$-1.212$], [1.469],   [10.99], [3.378],   [11.411],
    [7.40],  [$-0.212$], [0.045],   [8.78],  [1.168],   [1.364],
    [7.08],  [$-0.532$], [0.283],   [5.68],  [$-1.932$],[3.733],
    [8.87],  [1.258],    [1.583],   [8.18],  [0.568],   [0.323],
    [8.19],  [0.578],    [0.334],   [8.93],  [1.318],   [1.737],
    [11.15], [3.538],    [12.517],  [2.38],  [$-5.232$],[27.374],
    [6.68],  [$-0.932$], [0.869],   [5.62],  [$-1.992$],[3.968],
    [4.92],  [$-2.692$], [7.247],   [8.04],  [0.428],   [0.183],
    [7.18],  [$-0.432$], [0.187],   [11.52], [3.908],   [15.273],
    [6.29],  [$-1.322$], [1.748],   [7.96],  [0.348],   [0.121],
    table.cell(colspan: 5, align: right)[Сумма:], [91.770],
  ),
  caption: [Вычисление выборочной дисперсии],
) <variance-calc>

$ S^2 = (sum_(i=1)^n (x_i - overline(x))^2) / (n - 1) = 91.770 / 19 approx 4.830 $

Несмещённая оценка среднеквадратического отклонения:

$ S = sqrt(S^2) = sqrt(4.830) approx 2.198 $

== Задание 3. Доверительный интервал для среднего при известной дисперсии

Дисперсия генеральной совокупности считается известной (используется значение $S_в^2 approx 4.107$, то есть $S_в approx 2.026$ из выборки 1). Доверительный интервал строится на основе нормального распределения.

Критическое значение нормального распределения $t$ определяется из условия:

$ 2 Phi(t) = P = 1 - alpha = 0.95 arrow.double Phi(t) = 0.475 $

По таблице функции Лапласа: $t = 1.960$.

Предельная ошибка выборки:

$ Delta = t dot S_в / sqrt(n) = 1.960 dot 2.026 / sqrt(20) = 3.971 / 4.472 approx 0.888 $

Доверительный интервал:

$ overline(x) - Delta < mu < overline(x) + Delta $

$ 7.612 - 0.888 < mu < 7.612 + 0.888 $

$ 6.724 < mu < 8.500 $

== Задание 4. Доверительный интервал для среднего при неизвестной дисперсии

Дисперсия генеральной совокупности неизвестна. Используется распределение Стьюдента с $k = n - 1 = 19$ степенями свободы.

Критическое значение $t_"кр"$ определяется из условия:

$ P(-t_"кр" < T < t_"кр") = 1 - alpha $

При $alpha = 0.05$ и $k = 19$: $t_"кр" = 2.093$.

Предельная ошибка выборки:

$ Delta = t_"кр" dot S / sqrt(n) = 2.093 dot 2.198 / sqrt(20) = 4.600 / 4.472 approx 1.029 $

Доверительный интервал:

$ overline(x) - Delta < mu < overline(x) + Delta $

$ 7.612 - 1.029 < mu < 7.612 + 1.029 $

$ 6.583 < mu < 8.641 $

Интервал при неизвестной дисперсии шире, чем при известной, что отражает дополнительную неопределённость в оценке дисперсии.

== Задание 5. Доверительный интервал для дисперсии

Доверительный интервал для дисперсии строится на основе распределения $chi^2$ с $k = n - 1 = 19$ степенями свободы.

Квантили $chi^2$-распределения при $alpha = 0.05$ определяются из условий:

$ P(chi^2 < chi^2_(alpha\/2)) = alpha/2 = 0.025, quad P(chi^2 < chi^2_(1 - alpha\/2)) = 1 - alpha/2 = 0.975 $

По таблице: $chi^2_(0.025) = 8.907$, $chi^2_(0.975) = 32.852$.

Доверительный интервал для дисперсии:

$ k dot S^2 = 19 dot 4.830 = 91.770 $

$ (k dot S^2) / chi^2_(1 - alpha\/2) < sigma^2 < (k dot S^2) / chi^2_(alpha\/2) $

$ 91.770 / 32.852 < sigma^2 < 91.770 / 8.907 $

$ 2.793 < sigma^2 < 10.303 $

= Выводы

В ходе работы были выполнены следующие задачи.

По выборке 1 проверена гипотеза о нормальном распределении генеральной совокупности с помощью критерия Пирсона. Наблюдаемое значение $chi^2_"набл" approx 1.23$ меньше критического $chi^2_"крит" = 3.84$, поэтому нулевая гипотеза о нормальности принята.

По выборке 2 ($n = 20$) вычислены несмещённые оценки параметров: среднее $overline(x) approx 7.612$, дисперсия $S^2 approx 4.830$, среднеквадратическое отклонение $S approx 2.198$.

При известной дисперсии доверительный интервал для генерального среднего при $P = 0.95$ равен (6.724; 8.500).

При неизвестной дисперсии (по распределению Стьюдента) доверительный интервал для генерального среднего при $P = 0.95$ равен (6.583; 8.641).

Доверительный интервал для генеральной дисперсии при $P = 0.95$ равен (2.793; 10.303).
